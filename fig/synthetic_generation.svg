<svg xmlns="http://www.w3.org/2000/svg" width="720" height="360" viewBox="0 0 720 360">
  <style>
    .title { font: bold 24px sans-serif; }
    .subtitle { font: italic 16px sans-serif; }
    .label { font: 16px sans-serif; }
    .arrow { marker-end: url(#arrowhead); }
  </style>
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1f2933" />
    </marker>
  </defs>
  <rect width="720" height="360" fill="#f9fafb" stroke="#d2d6dc" />
  <text x="360" y="40" class="title" text-anchor="middle">Synthetic Two-Step Task Generator</text>
  <text x="360" y="70" class="subtitle" text-anchor="middle">Long dwell phases with rare/common transitions</text>

  <rect x="60" y="110" width="200" height="80" rx="12" ry="12" fill="#e1efff" stroke="#2c5282" />
  <text x="160" y="140" class="label" text-anchor="middle">Latent phase</text>
  <text x="160" y="165" class="label" text-anchor="middle">sampling (sticky HMM)</text>

  <rect x="60" y="220" width="200" height="80" rx="12" ry="12" fill="#fef3c7" stroke="#92400e" />
  <text x="160" y="250" class="label" text-anchor="middle">State-specific</text>
  <text x="160" y="275" class="label" text-anchor="middle">reward templates R₀/R₁</text>

  <rect x="280" y="160" width="200" height="80" rx="12" ry="12" fill="#dcfce7" stroke="#166534" />
  <text x="380" y="190" class="label" text-anchor="middle">Mixture policy</text>
  <text x="380" y="215" class="label" text-anchor="middle">π = softmax(β·Q)</text>

  <rect x="500" y="110" width="160" height="80" rx="12" ry="12" fill="#e0e7ff" stroke="#3730a3" />
  <text x="580" y="140" class="label" text-anchor="middle">Action</text>
  <text x="580" y="165" class="label" text-anchor="middle">sample</text>

  <rect x="500" y="220" width="160" height="80" rx="12" ry="12" fill="#fee2e2" stroke="#b91c1c" />
  <text x="580" y="250" class="label" text-anchor="middle">Transition</text>
  <text x="580" y="275" class="label" text-anchor="middle">& reward draw</text>

  <path d="M260 150 H280" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <path d="M260 260 H280" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <path d="M480 200 H500" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <path d="M200 110 L240 90 L280 110" fill="none" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <text x="260" y="95" class="label" text-anchor="middle">phase ↦ agent mix</text>
  <path d="M480 200 L520 200" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <path d="M580 190 V220" stroke="#1f2933" stroke-width="3" marker-end="url(#arrowhead)" />
  <text x="360" y="320" class="label" text-anchor="middle">Outputs: actions aₜ, rewards rₜ, transition type, latent phase labels</text>
</svg>
